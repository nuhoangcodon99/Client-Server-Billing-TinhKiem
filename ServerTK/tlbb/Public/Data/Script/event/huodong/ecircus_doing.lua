--ÂíÏ·ÍÅ»î¶¯

--½Å±¾ºÅ
x808005_g_ScriptId			= 808005
x808005_g_ScriptId_Ctrl	= 808006	--»Øµ÷½Å±¾

x808005_g_PrizeBase			= 1--8000		--»ñµÃ´ó½±µÄ¼¸ÂÊ»ùÊý
x808005_g_PrizeMoney		= 10000		--tien vang 10v
x808005_g_Prize0				= 30505194--phao hoa
x808005_g_Prize1				= 30505193--phao hoa
x808005_g_RoundMax			= 0--1			--s¯ vòng thñc hi®n nhi®m vø cho 1 nv
--Ò»ÌìÖÐ¿ÉÒÔÁìÈ¡µÄ×î´ó»·Êý

x808005_g_ExpBase = 500000
x808005_g_PrizeList = {

	50713004, --hong bao thach cap 7
	30505107, --tieu lac ba
	30008018,--Thanh Tâm Ðan
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30008014,--Thông Thiên Linh Ðan--10
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù 
	50713004, --hong bao thach cap 7
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	50713004, --hong bao thach cap 7
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù --20
	30008019,--Ð£c Xá L®nh
	30008014,--Thông Thiên Linh Ðan
	50721001,--hoang minh thach
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan --30
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	50721002,--lam minh thach
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30900016,--cao c¤p hþp thành phù --40
	50721003,--hong minh thach
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	50721004,--luc minh thach
	30008019,--Ð£c Xá L®nh  --50
	50713004, --hong bao thach cap 7
	30505107, --tieu lac ba
	30008018,--Thanh Tâm Ðan
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30008014,--Thông Thiên Linh Ðan--10
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù 
	50713004, --hong bao thach cap 7
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	50713004, --hong bao thach cap 7
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù --20
	30008019,--Ð£c Xá L®nh
	30008014,--Thông Thiên Linh Ðan
	50721001,--hoang minh thach
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan --30
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	50721002,--lam minh thach
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30900016,--cao c¤p hþp thành phù --40
	50721003,--hong minh thach
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	50721004,--luc minh thach
	30008019,--Ð£c Xá L®nh  --50
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	50721004,--luc minh thach
	30008019,--Ð£c Xá L®nh  --50
	50713004, --hong bao thach cap 7
	30505107, --tieu lac ba
	30008018,--Thanh Tâm Ðan
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30008014,--Thông Thiên Linh Ðan--10
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù 
	50713004, --hong bao thach cap 7
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	50713004, --hong bao thach cap 7
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù --20
	30008019,--Ð£c Xá L®nh
	30008014,--Thông Thiên Linh Ðan
	50721001,--hoang minh thach
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan --30
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	50721002,--lam minh thach
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30900016,--cao c¤p hþp thành phù --40
	50721003,--hong minh thach
	30008014,--Thông Thiên Linh Ðan
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	30008014,--Thông Thiên Linh Ðan
	30900016,--cao c¤p hþp thành phù
	30900016,--cao c¤p hþp thành phù
	30008019,--Ð£c Xá L®nh
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	30505107, --tieu lac ba
	50721004,--luc minh thach
	
}
--²Ù×÷¼¯
x808005_g_Key	=
{
	["chg"]			= 100,		--Ìá½»ÕäÊÞ£¬¶Ò»»½±Àø
	["inf"]			= 101,		--¹ØÓÚ
}

--×Ö´®¼¯
x808005_g_Str	=
{
	--²»°üº¬×ªÒå×Ö·ûµÄ×Ö´®
	["inf2"]		= "  #Wngoài ra chï c¥n ðßa ra trân thú bäo bäo là ðßþc, còn thÑc ån Nhuª Tß s¨ tuÏ ch÷n mµt thÑ trong thÑc ån chï ð¸nh các hÕ mang theo trên ngß¶i .",
	["ful"]			= "  Th§t ngÕi quá, hôm nay ð¬ các hÕ tìm thÑc ån và trân thú nhi«u thª này, bên tÕi hÕ g¥n nhß ðã ðü. Hoan nghênh l¥n sau ðªn tìm tÕi hÕ.",
	["bty1"]		= "  #Wða tÕ các hÕ cung c¤p thÑc ån cho trân thú, ðây là mµt chút lòng thành cüa tÕi hÕ, xin các hÕ nh§n l¤y.",
	["bty2"]		= "  #Wða tÕ các hÕ ðã làm nhi«u chuy®n vì tÕi hÕ. — ðây có mµt ph¥n thß·ng ð£c bi®t xin t£ng các hÕ. Chúc các hÕ có mµt ngày hÕnh phúc ð£c bi®t#W.",

	--°üº¬×ªÒå×Ö·ûµÄ×Ö´®
	["inf1"]		= "  #WThÑ 2 và thÑ 6 hàng tu¥n ðem thÑc ån và trân thú bäo bäo ðªn tìm Nhuª Tß. M²i l¥n giao trân thú bäo bäo Nhu® Tß cûng l¤y mµt loÕi trong các thÑc ån các hÕ mang theo. M²i l¥n giao mµt Trân thú và mµt loÕi thÑc ån s¨ nh§n ðßþc #{_MONEY"..x808005_g_PrizeMoney.."}, ngoài ra có xác su¤t nh¤t ð¸nh s¨ nh§n ðßþc #Gph¥n thß·ng ð£c bi®t#W.",
	["inf_pet"]	= "  #WTrân thú bäo bäo Nhuª Tß thu mua có: #r#G%s#W.",
	["inf_itm"]	= "  #WNgoài ra hãy nh¾, khi mang trân thú bäo bäo ðªn nh¾ mang theo mµt loÕi thÑc ån b¤t kÏ, nªu không Nhuª Tß s¨ t× ch¯i nh§n trân thú bäo bäo. #r#WThÑc ån Nhuª Tß c¥n có: #r#G%s#W.",
	["ned_pet"]	= "  #WtÕi hÕ chï c¥n nhæng trân thú bäo bäo sau: #r#G%s#W.",
	["ned_itm"]	= "  #WTrân thú các hÕ ðßa cho tÕi hÕ là ðúng r°i, nhßng tÕi hÕ còn c¥n mµt loÕi thÑc ån b¤t kÏ sau: #r#G%s#W.",
	["msg_bty"]	= "#R#{_INFOUSR%s} mang trân thú bäo bäo và thÑc ån ðªn cho sÑ giä ðoàn xiªc ð¬ ông ta xem, sau ðó ông ta l¤y ra ðßa cho #{_INFOUSR%s} ph¥n thß·ng là #{_INFOMSG%s} ð°ng th¶i chúc m×ng #Y8-3 #Rvui vë, th§t b¤t ng¶.",
}

--ÕäÊÞ¼¯
x808005_g_Pet	=
{
	[1]	= { id = 3099, name = "Tích D¸ch Bäo Bäo " },
	[2]	= { id = 3129, name = "NgÕc Ngß Bäo Bäo " },
	[3]	= { id = 3109, name = "Bi¬n BÑc Bäo Bäo " },
	[4]	= { id = 3119, name = "Ðß¶ng Lang Bäo Bäo " },
	[5]	= { id = 3139, name = "Miêu Ð¥u ¿ng Bäo Bäo " },
	[6]	= { id = 3149, name = "Ch°n Bäo Bäo " },
	[7]	= { id = 3159, name = "H± Bäo Bäo " },
	[8]	= { id = 3169, name = "Dã Trß Bäo Bäo " },
}

--ÎïÆ·¼¯
x808005_g_Itm	=
{
	[1]	= { id = 30101064, name = "HÕnh Nhân Tô" },
	[2]	= { id = 30101054, name = "Bánh khoai" },
	[3]	= { id = 30101065, name = "Thanh Minh Ba" },
	[4]	= { id = 30101055, name = "Nhu M­ Cao" },
	[5]	= { id = 30101066, name = "Ba Tiêu Ham PhÕn" },
	[6]	= { id = 30101056, name = "Hß½ng Cô Thái Bao" },
	[7]	= { id = 30101084, name = "Quan Thang Bao" },
	[8]	= { id = 30101074, name = "Kiêu Ch¤p Ngß Phiªn" },
	[9]	= { id = 30101085, name = "LÕp Thiêu Hß½ng Loa" },
	[10]= { id = 30101075, name = "Mã Nghîa Thßþng Thø" },
	[11]= { id = 30101086, name = "Ph¤n Chßng Áp Nhøc" },
	[12]= { id = 30101076, name = "Bát Trân Thuçn Kê Thang" },
	[13]= { id = 30101061, name = "Løc Ð§u Cao" },
	[14]= { id = 30101051, name = "D¥u Ti«n" },
}

--**********************************
--ÈÎÎñÈë¿Úº¯Êý
--**********************************
function x808005_OnDefaultEvent( sceneId, selfId, targetId )

	--Ñ¡Ôñ°´Å¥
	local	key	= GetNumText()

	--Ìá½»ÕäÊÞºÍÊ³Îï
	if key == x808005_g_Key["chg"] then
		--hd add 08-03-2013
		if GetHour() < 10 then
			x808005_MyNotifyTip( sceneId, selfId, "Chßa ðªn gi¶ b¡t ð¥u hoÕt ðµng !" )
			return
		end
		if GetSex(sceneId,selfId) ==1 then
			x808005_MyNotifyTip( sceneId, selfId, "R¤t tiªc, các hÕ không phäi là næ !" )
			return
		end
		if GetLevel( sceneId, selfId ) < 30 then
			x808005_MyNotifyTip( sceneId, selfId, "C¤p ðµ t¯i thi¬u là 30 !" )
			return
		end
		--end hd add 08-03-2013
		if CallScriptFunction( x808005_g_ScriptId_Ctrl, "IsActivityDoing", sceneId ) == 1 then
			--´ò¿ªÕäÊÞ½çÃæ
			str_1	= format( "  #WTÕi hÕ chï c¥n nhæng trân thú bäo bäo sau: #r  #G%s#W.", x808005_MyGetBuyList( 0 ) )
			str_2	= format( "  #Wvà nhæng thÑc ån sau: #r  #G%s#W.", x808005_MyGetBuyList( 1 ) )
			BeginEvent( sceneId )
				AddText( sceneId, str_1 )
				AddText( sceneId, str_2 )
			EndEvent( sceneId )
			DispatchMissionDemandInfo( sceneId, selfId, targetId, x808005_g_ScriptId, -1, 2 )
		else
			x808005_MyNotifyTip( sceneId, selfId, "Bây gi¶ không phäi là th¶i gian hoÕt ðµng!" )
		end

	--¹ØÓÚ
	elseif key == x808005_g_Key["inf"] then
		str_1	= format( x808005_g_Str["inf_pet"], x808005_MyGetBuyList( 0 ) )
		str_2	= format( x808005_g_Str["inf_itm"], x808005_MyGetBuyList( 1 ) )
		BeginEvent( sceneId )
			AddText( sceneId, x808005_g_Str["inf1"] )
			if str_1 ~= nil then
				AddText( sceneId, str_1 )
			end
			if str_2 ~= nil then
				AddText( sceneId, str_2 )
			end
			AddText( sceneId, x808005_g_Str["inf2"] )
		EndEvent( sceneId )
		DispatchEventList( sceneId, selfId, targetId )
	end

end

--**********************************
--ÁÐ¾ÙÊÂ¼þ
--**********************************
function x808005_OnEnumerate( sceneId, selfId, targetId )
	
	if CallScriptFunction( x808005_g_ScriptId_Ctrl, "IsActivityDoing", sceneId ) == 1 then
		if GetHour() < 10 then
			AddText( sceneId, "#YBây gi¶ là #G"..GetHour().."#Y gi¶. #b#YChßa ðªn gi¶ b¡t ð¥u hoÕt ðµng ! " )
			--return
		else
			AddNumText( sceneId, x808005_g_ScriptId, "#P[Event]#YQuà t£ng giai nhân 8-3", 6, x808005_g_Key["chg"] )
		end
	end
	--AddNumText( sceneId, x808005_g_ScriptId, "Các hoÕt ðµng cüa ðoàn xiªc", 11, x808005_g_Key["inf"] )

end

--**********************************
--»î¶¯½±Àø
--**********************************
function x808005_MyOnBounty( sceneId, selfId, targetId, indexitm, indexpet )

	local	num_chg	= 0
	local	num_bty	= 0
	
	--µ±ÌìµÄ»·Êý¿ØÖÆ
	--100000µÄ±¶ÊýÊÇµ±Ç°Íê³ÉµÄ»·Êý£¬Ð¡ÓÚ100000µÄÊýÊÇÊ±¼ä
	--begin modified by zhangguoxin 090207
	local iDayCount	= GetMissionData( sceneId, selfId, MD_CIRCUS_DAYCOUNT )
	if iDayCount == nil or iDayCount < 0 then
		iDayCount			= 0
	end
	local iTime			= iDayCount - floor( iDayCount/100000 ) * 100000
	--local iDayTime	= floor( iTime/100 )									--ÉÏÒ»´Î½»»ò·ÅÆúÈÎÎñµÄÊ±¼ä(ÌìÊý)
	local iDayTime	= iTime																	--ÉÏÒ»´Î½»»ò·ÅÆúÈÎÎñµÄÊ±¼ä(ÌìÊý)
	--local iQuaTime	= iTime - floor( iTime/100 ) * 100			--ÉÏÒ»´Î½»»ò·ÅÆúÈÎÎñµÄÊ±¼ä(¿Ì)
	local iDayHuan	= floor( iDayCount/100000 )							--µ±ÌìÄÚÍê³ÉµÄÈÎÎñ´ÎÊý
	--local CurTime		= GetHourTime()													--µ±Ç°Ê±¼ä
	--local CurDaytime= floor( CurTime/100 )									--µ±Ç°Ê±¼ä(Ìì)
	local CurDaytime = GetDayTime()														--µ±Ç°Ê±¼ä(Ìì)
	--local CurQuaTime = CurTime - floor( CurTime/100 ) * 100	--µ±Ç°Ê±¼ä(¿Ì)
	
	--ÉÏ´ÎÍê³ÉÈÎÎñÊÇÍ¬Ò»ÌìÄÚ
	if CurDaytime == iDayTime then
		iDayHuan			= iDayHuan + 1
		--iQuarterTime	= CurQuaTime
	--ÉÏ´ÎÍê³ÉÈÎÎñ²»ÔÚÍ¬Ò»Ìì£¬ÖØÖÃ
	else
		iDayTime			= CurDaytime
		iQuarterTime	= 0
		iDayHuan			= 0
	end
	if iDayHuan >= x808005_g_RoundMax then
		x808005_MyMsgBox( sceneId, selfId, targetId, x808005_g_Str["ful"] )
		return 0
	else
		--iDayCount			= iDayHuan * 100000 + iDayTime * 100 + iQuarterTime
		iDayCount			= iDayHuan * 100000 + iDayTime;
	end
	--end modified by zhangguoxin 090207
	
	--ÒªÔÚ±£Ö¤ÕäÊÞ¡¢ÎïÆ·Ìá½»¶¼ÕýÈ·µÄÇéÐÎÏÂ£¬ÔÙ½øÐÐÖðÒ»É¾³ý
	if indexpet < 0 or indexpet >= 255 or LuaFnIsPetAvailable( sceneId, selfId, indexpet ) ~= 1 then
		x808005_MyNotifyTip( sceneId, selfId, "Vô hi®u trân thú!" )
		return 0
	end
	if indexitm < 0 or indexitm >= 255 or LuaFnIsItemAvailable( sceneId, selfId, indexitm ) ~= 1 then
		x808005_MyNotifyTip( sceneId, selfId, "Vô hi®u thÑc ån!" )
		return 0
	end
	--¼ì²éÊÇ·ñÊÇËùÐèÕäÊÞ
	local	pet_id		= LuaFnGetPet_DataID( sceneId, selfId, indexpet )
	local	pet_ret		= 0
	local	pet_unt
	for i = 1, getn( x808005_g_Pet ) do
		pet_unt				= x808005_g_Pet[ i ]
		if pet_id == pet_unt.id then
			pet_ret			= 1
			break
		end
	end
	if pet_ret ~= 1 then
		str	= format( x808005_g_Str["ned_pet"], x808005_MyGetBuyList( 0 ) )
		x808005_MyMsgBox( sceneId, selfId, targetId, str )
		return 0
	end
	--¼ì²éÊÇ·ñÊÇËùÐèÎïÆ·
	local	itm_id		= LuaFnGetItemTableIndexByIndex( sceneId, selfId, indexitm )
	local	itm_ret		= 0
	local	itm_unt
	for i = 1, getn( x808005_g_Itm ) do
		itm_unt				= x808005_g_Itm[ i ]
		if itm_id == itm_unt.id then
			itm_ret			= 1
			break
		end
	end
	if itm_ret ~= 1 then
		str	= format( x808005_g_Str["ned_itm"], x808005_MyGetBuyList( 1 ) )
		x808005_MyMsgBox( sceneId, selfId, targetId, str )
		return 0
	end

	--ÕäÊÞÌá½»
	if LuaFnDeletePet( sceneId, selfId, indexpet, 1 ) > 0 then
		x808005_MyNotifyTip( sceneId, selfId, "Các hÕ ðßa mµt con "..pet_unt.name.."." )
	else
		return 0
	end
	--ÎïÆ·Ìá½»
	if HaveItemInBag( sceneId, selfId, itm_id ) > 0 and
		LuaFnGetAvailableItemCount( sceneId, selfId, itm_id ) >= 1 and
		DelItem( sceneId, selfId, itm_id, 1 ) > 0 then
		x808005_MyNotifyTip( sceneId, selfId, "Các hÕ ðßa mµt loÕi "..itm_unt.name.."." )
	else
		return 0
	end

	if pet_ret == 1 and itm_ret == 1 then
		--³É¹¦¶Ò»»Ò»´Î£¬¼ÆÊýÎÞÉÏÏÞ
		num_chg			= CallScriptFunction( x808005_g_ScriptId_Ctrl, "OnSuccChange", sceneId )
		--Ç®½±Àø
		AddMoney( sceneId, selfId, x808005_g_PrizeMoney )
		--³É¹¦ËÍ³ö
		x808005_MyMsgBox( sceneId, selfId, targetId, x808005_g_Str["bty1"] )
		--³É¹¦ËÍ³öºóÉèÖÃ»·Êý
		SetMissionData( sceneId, selfId, MD_CIRCUS_DAYCOUNT, iDayCount )
		--Add Log
		LogInfo			= format( "[CIRCUS]: x808005_MyOnBounty( sceneId=%d, GUID=%0X ), pet=%d, itm=%d, num_chg=%d, num_bty=%d, PRIZE_MONEY(%d)",
			sceneId,
			LuaFnObjId2Guid( sceneId, selfId ),
			pet_id, itm_id, num_chg, num_bty, x808005_g_PrizeMoney )
		MissionLog( sceneId, LogInfo )
	else
		return 0
	end

	--´óÏó¼¸ÂÊ½±Àø
	--x808005_MyNotifyTip( sceneId, selfId, "Random : "..random( x808005_g_PrizeBase ) )
	if random( x808005_g_PrizeBase ) == 1 and LuaFnGetPropertyBagSpace( sceneId, selfId ) >= 3 and LuaFnGetMaterialBagSpace( sceneId, selfId ) >= 1 then
		--³É¹¦´ó½±Ò»´Î£¬¼ÆÊýÎÞÉÏÏÞ
		num_bty			= CallScriptFunction( x808005_g_ScriptId_Ctrl, "OnSuccPrize", sceneId )
		--x808005_MyNotifyTip( sceneId, selfId, "num_bty : "..num_bty )
		if num_bty > 0 then
			local	idBag0	= LuaFnTryRecieveItem( sceneId, selfId, x808005_g_Prize0, 1 )	--×øÆï
			local	idBag1	= LuaFnTryRecieveItem( sceneId, selfId, x808005_g_Prize1, 1 )	--ÆïÊõ
			local	idBag2	= LuaFnTryRecieveItem( sceneId, selfId, x808005_g_PrizeList[num_bty], 1 )
			local	szTran
			if idBag0 >= 0 and idBag1 >= 0 and idBag2 >= 0 then
				szTran			= GetBagItemTransfer( sceneId, selfId, idBag2 )
				--³É¹¦ËÍ³ö
				x808005_MyMsgBox( sceneId, selfId, targetId, x808005_g_Str["bty2"] )
				if szTran ~= nil then
					str				= format( x808005_g_Str["msg_bty"], GetName( sceneId, selfId ), GetName( sceneId, selfId ), szTran )
					x808005_MyGlobalNews( sceneId, str )
				end
				--Add Log
				LogInfo			= format( "[CIRCUS]: x808005_MyOnBounty( sceneId=%d, GUID=%0X ), pet=%d, itm=%d, num_chg=%d, num_bty=%d, PRIZE_ITEM(%d,%d)",
					sceneId,
					LuaFnObjId2Guid( sceneId, selfId ),
					pet_id, itm_id, num_chg, num_bty, x808005_g_Prize0, x808005_g_Prize1 )
				MissionLog( sceneId, LogInfo )
			end
		end
		if num_bty == 0 then
			x808005_MyMsgBox( sceneId, selfId, targetId, "Ta ðã phát ðü s¯ ph¥n quà m×ng ngày 8-3 r°i. Chúc các hÕ vui vë !" )
		end
	end
	return 1

end

--**********************************
--Íæ¼ÒÌá½»ÕäÊÞºóµÄ»Øµ÷º¯Êý
--**********************************
function x808005_OnMissionCheck( sceneId, selfId, npcid, scriptId, index1, index2, index3, indexpet )

	if indexpet >= 255 then
		--Ë÷ÒýÖµ·µ»Ø255±íÊ¾¿Õ£¬Ã»Ìá½»ÕäÊÞ
		x808005_MyNotifyTip( sceneId, selfId, "Hãy kéo trân thú vào trong cØa s±!" )
	elseif index1 < 0 or index1 >= 255 then
		x808005_MyNotifyTip( sceneId, selfId, "Hãy kéo thÑc ån vào ô v§t ph¦m ð¥u tiên!" )
	else
		x808005_MyOnBounty( sceneId, selfId, npcid, index1, indexpet )
	end

end

--**********************************
--»ñÈ¡ÊÕ¹ºÁÐ±í
--**********************************
function x808005_MyGetBuyList( type )

	local	str	= ""
	local	lst
	if type == 0 then
		lst			= x808005_g_Pet
	else
		lst			= x808005_g_Itm
	end

	for i = 1, getn( lst ) do
		if i ~= 1 then
			str		= str..", "
		end
		str		= str..lst[i].name
	end
	return str

end

--**********************************
--¶Ô»°¿òÌáÊ¾
--**********************************
function x808005_MyMsgBox( sceneId, selfId, targetId, str )

	BeginEvent( sceneId )
		AddText( sceneId, str )
	EndEvent( sceneId )
	DispatchEventList( sceneId, selfId, targetId )

end

--**********************************
--ÐÑÄ¿ÌáÊ¾
--**********************************
function x808005_MyNotifyTip( sceneId, selfId, str )

	BeginEvent( sceneId )
		AddText( sceneId, str )
	EndEvent( sceneId )
	DispatchMissionTips( sceneId, selfId )

end

--**********************************
--È«Çò¹«¸æ
--**********************************
function x808005_MyGlobalNews( sceneId, str )

	if str == nil then
		return
	end
	AddGlobalCountNews( sceneId, str )

end
