x000173_g_active = 1 --active event
x000173_g_scriptId = 000173
x000173_YQ8={
--yq bt 8
30308111,
30308112,
30308113,
30308114,
30308115,
30308116,
30308117,
30308118,
30308119,

30308121,
30308122,
30308123,
30308124,
30308125,
30308126,
30308127,
30308128,
30308129
}

x000173_ThuCuoi_PET ={
	10141567, --T÷a kÜ: Xích Luy®n Câu 30 ngay
	10141590, --T÷a kÜ: Bích Giáp Huy«n Quy 30 ngay
	10141505,--Thú cßÞi: ¿ng Long Huy­n H°n
	10141521,--T÷a kÜ: Nhung Tuyªt Th¥n Ngßu
	30309092,-- TrÑng trân thú : Thái Thßþng Long TØ
	30309095, --TrÑng trân thú : Mao Mao Ngßu
	30309093 , --TrÑng trân thú : Côn Luân Tiên Tu¤n
	10141476,--Thú cßÞi: Ám Viêm Minh Sß
	10141483,--Thú cßÞi: Hß Không Hùng H°n
	
}
x000173_ThuCuoi_PET_358 ={
	30308284, --TrÑng trân thú : Chien Binh Tu La
	
	10124606, --Lý Hý Lan Phß½ng
	10124610, --Døc Huyªt Hàn Phong
	10124614, --Bích ThuÖ Hàm Phß½ng
	10124625, --DÕ C¦m Thiên Lan
	10124630, --T¯ Vãn Huy«n Thß½ng
	10124633, --Thß½ng Vân Sß½ng Nguy®t


	10124624, --Ng÷c C¦m Kim Sa (nhuom)
	10124620, ----M£c Vû Ti«m U
	
	
	10141599, --T÷a kÜ: SC Nien Thu 7
	10141603,--T÷a kÜ: TC Nien Thu 7
	10141607,--T÷a kÜ: CC Nien Thu 7
	10141611,--T÷a kÜ: SiC Nien Thu 7
	10141615,--T÷a kÜ: DSC Nien Thu 7
	10141619,--T÷a kÜ: DDSC Nien Thu 7
	10141623,--T÷a kÜ: SC Thái Thßþng Long 7
	10141627,--T÷a kÜ: TC Thái Thßþng Long 7
	10141631,--T÷a kÜ: CC Thái Thßþng Long 7
	10141635,--T÷a kÜ: SC Thái Thßþng Long 7
	10141639,--T÷a kÜ: DSC Thái Thßþng Long 7
	10141643,--T÷a kÜ: SC Côn Lôn Tiên Tu¤n 7
	10141647,--T÷a kÜ: TC Côn Lôn Tiên Tu¤n 7
	10141651,--T÷a kÜ: CC Côn Lôn Tiên Tu¤n 7
	10141655,--T÷a kÜ: SiC Côn Lôn Tiên Tu¤n 7
	10141659,--T÷a kÜ: DSC Côn Lôn Tiên Tu¤n 7
	10141703,--T÷a kÜ: Tinh Vû Du Long 7
	10141708,--T÷a kÜ: Thß½ng Lan Vû Dñc 7
	10141713,--T÷a kÜ: Vân Tiêu Vû Dñc 7
	
}

x000173_NLLongVan={
	
	30308284, --TrÑng trân thú : Chien Binh Tu La
	
	10124606, --Lý Hý Lan Phß½ng
	10124610, --Døc Huyªt Hàn Phong
	10124614, --Bích ThuÖ Hàm Phß½ng
	10124625, --DÕ C¦m Thiên Lan
	10124630, --T¯ Vãn Huy«n Thß½ng
	10124633, --Thß½ng Vân Sß½ng Nguy®t


	10124624, --Ng÷c C¦m Kim Sa (nhuom)
	10124620, ----M£c Vû Ti«m U
	
	
	10141599, --T÷a kÜ: SC Nien Thu 7
	10141603,--T÷a kÜ: TC Nien Thu 7
	10141607,--T÷a kÜ: CC Nien Thu 7
	10141611,--T÷a kÜ: SiC Nien Thu 7
	10141615,--T÷a kÜ: DSC Nien Thu 7
	10141619,--T÷a kÜ: DDSC Nien Thu 7
	10141623,--T÷a kÜ: SC Thái Thßþng Long 7
	10141627,--T÷a kÜ: TC Thái Thßþng Long 7
	10141631,--T÷a kÜ: CC Thái Thßþng Long 7
	10141635,--T÷a kÜ: SC Thái Thßþng Long 7
	10141639,--T÷a kÜ: DSC Thái Thßþng Long 7
	10141643,--T÷a kÜ: SC Côn Lôn Tiên Tu¤n 7
	10141647,--T÷a kÜ: TC Côn Lôn Tiên Tu¤n 7
	10141651,--T÷a kÜ: CC Côn Lôn Tiên Tu¤n 7
	10141655,--T÷a kÜ: SiC Côn Lôn Tiên Tu¤n 7
	10141659,--T÷a kÜ: DSC Côn Lôn Tiên Tu¤n 7
	10141703,--T÷a kÜ: Tinh Vû Du Long 7
	10141708,--T÷a kÜ: Thß½ng Lan Vû Dñc 7
	10141713,--T÷a kÜ: Vân Tiêu Vû Dñc 7
	20310180,-- T¸ch Vân Thüy
	20310180,-- T¸ch Vân Thüy
	20310180,-- T¸ch Vân Thüy
	20310180,-- T¸ch Vân Thüy
	20310180,-- T¸ch Vân Thüy
	20310181,--Xuyªt Long ThÕch_Nguyên
	20310182,--Xuyªt Long ThÕch_BÕo
	20310183,--Xuyªt Long ThÕch_Thß½ng
	--38000152,--chu van tinh ngoc +5
	38000184,--chu van tinh ngoc +5 khong co dinh
}


function x000173_OnDefaultEvent( sceneId, selfId, targetId )
	BeginEvent( sceneId )
		local strText = "#WHãy thu th§p 1 s¯ lßþng nh¤t ð¸nh #GTh¤t Thái HÕt #Wvà mang t¾i tìm ta. Ta s¨ trao cho b¢ng hæu nhæng ph¥n quà h¤p dçn "
		AddText( sceneId, strText )
		AddNumText( sceneId, x000173_g_scriptId, "Ð±i ph¥n thß·ng #GTh¤t Thái HÕt", 3, 1)
			AddNumText( sceneId, x000173_g_scriptId, "V« event tìm kiªm #G Th¤t Thái HÕt", 11, 2)
	EndEvent(sceneId)
	DispatchEventList(sceneId,selfId,targetId)
end

function x000173_OnEnumerate( sceneId, selfId, targetId )
	if x000173_g_active ==1 then
		--BeginEvent( sceneId )
			local strText = "#WHãy thu th§p 1 s¯ lßþng nh¤t ð¸nh #GTh¤t Thái HÕt #Wvà mang t¾i tìm ta. Ta s¨ trao cho b¢ng hæu nhæng ph¥n quà h¤p dçn "
			AddText( sceneId, strText )
			AddNumText( sceneId, x000173_g_scriptId, "Ð±i ph¥n thß·ng #GTh¤t Thái HÕt", 3, 1)
			AddNumText( sceneId, x000173_g_scriptId, "V« event tìm kiªm #G Th¤t Thái HÕt", 11, 2)
		--EndEvent(sceneId)
		--DispatchEventList(sceneId,selfId,targetId)
	end
end

function x000173_OnEventRequest( sceneId, selfId, targetId, eventId )
	local item = LuaFnGetAvailableItemCount(sceneId, selfId,20600019)-- ðªm s¯ item th¤t thái hÕt
	local slot =LuaFnGetPropertyBagSpace( sceneId, selfId)
	local slot2 =LuaFnGetMaterialBagSpace( sceneId, selfId) --check slot bag nl
	if GetNumText()==1 then
		BeginEvent( sceneId )
			local strText = "#WB¢ng hæu hãy lña ch÷n s¯ lßþng #G Th¤t Thái HÕt#W tß½ng Ñng ð¬ có th¬ nh§n quà!!!! "
			AddText( sceneId, strText )
			AddNumText( sceneId, x000173_g_scriptId, "Ð±i #Y10 #GTh¤t Thái HÕt l¤y 1 ph¥n quà", 3, 10)
			AddNumText( sceneId, x000173_g_scriptId, "Ð±i #Y20 #GTh¤t Thái HÕt l¤y 1 ph¥n quà", 3, 20)
			AddNumText( sceneId, x000173_g_scriptId, "Ð±i #Y50 #GTh¤t Thái HÕt l¤y 1 ph¥n quà", 3, 50)
		EndEvent(sceneId)
		DispatchEventList(sceneId,selfId,targetId)
	end
	if GetNumText()==10 then
		if slot <1 then
			x000173_Tips(sceneId, selfId,targetId,"B¢ng hæu hãy ð¬ ít nh¤t 1 ô tr¯ng trong tay näi!!")
			x000173_FailTips(sceneId,selfId,"B¢ng hæu hãy ð¬ ít nh¤t 1 ô tr¯ng trong tay näi!!")
			return
		elseif  item<10 then
			x000173_Tips(sceneId, selfId,targetId,"B¢ng hæu không ðü s¯ lßþng #GTh¤t Thái HÕt")
			x000173_FailTips(sceneId, selfId,"B¢ng hæu không ðü s¯ lßþng #GTh¤t Thái HÕt")
			return
			
		end
		LuaFnDelAvailableItem(sceneId,selfId,20600019,10)

		---------------------a Hd edit cho nh§n v§t ph¦m cùi b¡p · mÑc này----------------------------------------------
		local ran = random(getn(x000173_YQ8))
		local BagPos = TryRecieveItem(sceneId,selfId,x000173_YQ8[ran], QUALITY_MUST_BE_CHANGE )
		
		--end phan thuong
		x000173_Tips(sceneId, selfId,targetId,"Nh§n thß·ng thành công")
		x000173_FailTips(sceneId,selfId,"Nh§n thß·ng thành công")
	end
	if GetNumText()==20 then
		if slot <1 then
			x000173_Tips(sceneId, selfId,targetId,"B¢ng hæu hãy ð¬ ít nh¤t 1 ô tr¯ng trong tay näi!!")
			x000173_FailTips(sceneId,selfId,"B¢ng hæu hãy ð¬ ít nh¤t 1 ô tr¯ng trong tay näi!!")
			return
		elseif  item<20 then
			x000173_Tips(sceneId, selfId,targetId,"B¢ng hæu không ðü s¯ lßþng #GTh¤t Thái HÕt")
			x000173_FailTips(sceneId, selfId,"B¢ng hæu không ðü s¯ lßþng #GTh¤t Thái HÕt")
			return
			
		end
		LuaFnDelAvailableItem(sceneId,selfId,20600019,20)

		---------------------a Hd edit cho nh§n v§t ph¦m h½i h½i ngon · mÑc này----------------------------------------------
		local ran = random(getn(x000173_ThuCuoi_PET))
		local BagPos = TryRecieveItem(sceneId,selfId,x000173_ThuCuoi_PET[ran], QUALITY_MUST_BE_CHANGE )
		
		--end phan thuong
		
		x000173_Tips(sceneId, selfId,targetId,"Nh§n thß·ng thành công")
		x000173_FailTips(sceneId,selfId,"Nh§n thß·ng thành công")
	end
	if GetNumText()==50 then
		if slot <1 or slot2 <1 then
			x000173_Tips(sceneId, selfId,targetId,"B¢ng hæu hãy ð¬ ít nh¤t 1 ô tr¯ng ðÕo cø và nguyên li®u trong tay näi !")
			x000173_FailTips(sceneId,selfId,"B¢ng hæu hãy ð¬ ít nh¤t 1 ô tr¯ng ðÕo cø và nguyên li®u trong tay näi!!")
			return
		elseif  item<50 then
			x000173_Tips(sceneId, selfId,targetId,"B¢ng hæu không ðü s¯ lßþng #GTh¤t Thái HÕt")
			x000173_FailTips(sceneId, selfId,"B¢ng hæu không ðü s¯ lßþng #GTh¤t Thái HÕt")
			return
			
		end
		LuaFnDelAvailableItem(sceneId,selfId,20600019,50)

		---------------------a Hd edit cho nh§n v§t ph¦m ngon · mÑc này----------------------------------------------
		local ran = random(getn(x000173_NLLongVan))
		local BagPos = TryRecieveItem(sceneId,selfId,x000173_NLLongVan[ran], QUALITY_MUST_BE_CHANGE )
		local transfer = GetBagItemTransfer(sceneId,selfId,BagPos)
		local str = format("#cff99cc#{_INFOUSR%s} v¤t vä tham gia sñ ki®n #Y[Truy Tìm Th¤t Thái HÕt] #P. Tri«u ðình ban thß·ng #{_INFOMSG%s} xem nhß là món quà khích l®. ", GetName(sceneId,selfId),transfer)
		if ran >= (getn(x000173_NLLongVan) - 8)then
			BroadMsgByChatPipe(sceneId, selfId, str, 4) --he thong
		else
			BroadMsgByChatPipe(sceneId, selfId, str, 0) ---lan can
		end
		--end phan thuong
		
		x000173_Tips(sceneId, selfId,targetId,"Nh§n thß·ng thành công")
		x000173_FailTips(sceneId,selfId,"Nh§n thß·ng thành công")
	end
	if GetNumText()==2 then
		BeginEvent( sceneId )
			local text1 ="#WTham gia các hoÕt ðµng #GTrân Long KÏ Cuµc, Ác T£c, Ác Bá, Lâu Lan T¥m Bäo, Tô Châu 1 2 3.... #WB¢ng hæu có tï l® nh§n ðßþc v§t ph¦m #G Th¤t Thái HÕt#r"
			local text2="#WMang ðü s¯ lßþng #GTh¤t Thái HÕt#W nh¤t ð¸nh ðªn g£p NPC sñ ki®n tiªn hành ð±i quà t£ng."
			AddText(sceneId,text1)
			AddText(sceneId,text2)
		EndEvent(sceneId)
		DispatchEventList(sceneId,selfId,targetId)
		return
	end
end

function x000173_Tips(sceneId, selfId,targetId,Tips)
	BeginEvent(sceneId)
		AddText(sceneId, Tips)
	EndEvent(sceneId)
	DispatchEventList(sceneId,selfId,targetId)
end

function x000173_FailTips(sceneId, selfId,Tips)
	BeginEvent(sceneId)
		AddText(sceneId, Tips)
	EndEvent(sceneId)
	DispatchMissionTips(sceneId, selfId)
end
