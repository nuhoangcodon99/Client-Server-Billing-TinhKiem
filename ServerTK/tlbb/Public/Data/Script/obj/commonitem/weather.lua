--×¢Òâ£º

--ÎïÆ·¼¼ÄÜµÄÂß¼­Ö»ÄÜÊ¹ÓÃ»ù´¡¼¼ÄÜºÍ½Å±¾À´ÊµÏÖ

--½Å±¾:

--½Å±¾ºÅ
x331026_g_scriptId = 331026 --ÁÙÊ±Ğ´Õâ¸ö,ÕæÕıÓÃµÄÊ±ºòÒ»¶¨Òª¸Ä.

-- effect = Client/Config/EffectDefine.txtÖĞ¶¨ÒåµÄ
-- time = ³ÖĞøÊ±¼ä(Ãë)

x331026_g_itemList = {}
x331026_g_itemList[30509029] = {effect=2, time=60,
	msg1="#W#{_INFOUSR%s}#H th¤y ğã lâu không mßa, cây c¯i ruµng ğ¤t khô c¢n, không ğành lòng nên ğã l¤y 1 %s#H, mi®ng l¦m b¦m, 1 lúc sau chï th¤y mây ğen ğen kéo ğ¥y tr¶i, mßa gió bão bùng.",
	msg2="#W#{_INFOUSR%s}#H th¤y ·#G%s#H ğã lâu không mßa, cây c¯i ruµng ğ¤t khô c¢n, không ğành lòng nên ğã l¤y 1 %s#H, mi®ng l¦m b¦m, 1 lúc sau chï th¤y mây ğen ğen kéo ğ¥y tr¶i, mßa gió bão bùng."}
x331026_g_itemList[30509030] = {effect=3, time=60,
	msg1="#W#{_INFOUSR%s}#H Ğang ğÑng tÕi ngß¶i yêu cüa mình l§p l¶i th«, nªu nhß có phø lòng sau này s¨ b¸ tr¶i ğánh. V×a nói dÑt câu, không ng¶ mây ğen kéo ğªn, s¤m ch¾p ¥m ¥m. Lúc ğó hù ğªn nét m£t ğ¥y v¨ kinh sş. Sau này phát hi®n Không ng¶ là do %s#H làm ra.",
	msg2="#W#{_INFOUSR%s}#H Ğang ğÑng tÕi ngß¶i yêu cüa mình l§p l¶i th«, nªu nhß có phø lòng sau này s¨ b¸ tr¶i ğánh. V×a nói dÑt câu, #G%s#H không ng¶ mây ğen kéo ğªn, s¤m ch¾p ¥m ¥m. Lúc ğó hù ğªn nét m£t ğ¥y v¨ kinh sş. Sau này phát hi®n Không ng¶ là do %s#H làm ra."}
x331026_g_itemList[30509031] = {effect=4, time=60,
	msg1="#W#{_INFOUSR%s}#H b¸ 1 ğám ti¬u tØ qu¤y r¥y liên tøc và không còn bi®n pháp nào khác, chï còn l¤y bäo v§t %s#H ğã c¤t gi¤u lâu nay, gào lên 1 tiªng \"Oan!\", trên tr¶i b±ng xu¤t hi®n 1 lu°ng tuyªt Nga mao r¾t xu¯ng, lû ti¬u tØ kinh sş quá bö chÕy.",
	msg2="#W#{_INFOUSR%s}#H tÕi G%s#H b¸ 1 ğám ti¬u tØ qu¤y g¥y liên tøc và không còn bi®n pháp nào khác, chï còn l¤y bäo v§t %s#H ğã c¤t gi¤u lâu nay, gào lên 1 tiªng \"Oan!\", trên tr¶i b±ng xu¤t hi®n 1 lu°ng tuyªt Nga mao r¾t xu¯ng, lû ti¬u tØ kinh sş quá bö chÕy."}
x331026_g_itemList[30509032] = {effect=5, time=60,
	msg1="#W#{_INFOUSR%s}#H vì gia tång không khí cüa sñ lãng mÕng v¾i ngß¶i yêu cüa mình tÕi Hoa ti«n nguy®t hÕ, sØ døng %s#H v§t ph¦m này không d­ có ğßşc này ",
	msg2="#W#{_INFOUSR%s}#H vì gia tång không khí cüa sñ lãng mÕng v¾i ngß¶i yêu cüa mình tÕi #G%s#H, sØ døng %s#H v§t ph¦m này không d­ có ğßşc này "}
x331026_g_itemList[30509033] = {effect=6, time=60,
	msg1="#W#{_INFOUSR%s}#H ğang cùng cao thü võ lâm tÖ võ %s#H, khi th¤y trúc di®p bay ğ¥y tr¶i, ngay l§p tÑc tr· nên khí thª h½n ngß¶i.",
	msg2="#W#{_INFOUSR%s}#H ğang cùng cao thü võ lâm · #G%s#HtÖ võ, sØ døng trß¾c 1 %s#H, khi th¤y trúc di®p bay ğ¥y tr¶i, ngay l§p tÑc tr· nên khí thª h½n ngß¶i."}
x331026_g_itemList[30509034] = {effect=7, time=60,
	msg1="#W#{_INFOUSR%s}#H trong lúc ğang ği dÕo, ngçu hÑng làm th½, sØ døng 1 %s#H, m¡t nhìn phong di®p bay ğ¥y tr¶i, buµc mi®ng ngâm ra câu \"Sß½ng di®p h°ng vu nh¸ nguy®t hoa\", làm ngß¶i ği ğß¶ng r¤t ¤n tßşng.",
	msg2="#W#{_INFOUSR%s}#H ·#G%s#H trong lúc ğang ği dÕo, ngçu hÑng làm th½, sØ døng 1 %s#H, m¡t nhìn phong di®p bay ğ¥y tr¶i, buµc mi®ng ngâm ra câu \"Sß½ng di®p h°ng vu nh¸ nguy®t hoa\", làm ngß¶i ği ğß¶ng r¤t ¤n tßşng."}
x331026_g_itemList[30509035] = {effect=8, time=60,
	msg1="#W#{_INFOUSR%s}#H ğ«u b¸ m÷i ngß¶i chê khuôn m£t cüa mình, trong lòng không cam tâm, trong lúc gi§n dæ ğã sØ døng 1 %s#H, sau ğó t× trong b¥u tr¶i ğ¥y cát bøi ği ra, r¤t hài lòng v¾i sñ thay ğ±i cüa bän thân.",
	msg2="#W#{_INFOUSR%s}#H ğ«u b¸ m÷i ngß¶i chê khuôn m£t cüa mình, trong lòng không cam tâm, ğã · #G%s#H sØ døng 1 %s#H, sau ğó t× trong b¥u tr¶i ğ¥y cát bøi ği ra, r¤t hài lòng v¾i sñ thay ğ±i cüa bän thân."}
x331026_g_itemList[30509036] = {effect=9, time=60,
	msg1="#W#{_INFOUSR%s}#H n¢m m½ cûng mu¯n phát tài, cho nên sØ døng 1 %s#H, ngay l§p tÑc nguyên bäo r½i nhß mßa, m÷i ngß¶i vui m×ng hoan hô.",
	msg2="#W#{_INFOUSR%s}#H n¢m m½ cûng mu¯n phát tài, nên · #G%s#H sØ døng 1 %s#H, ngay l§p tÑc nguyên bäo r½i nhß mßa, m÷i ngß¶i vui m×ng hoan hô."}
x331026_g_itemList[30509052] = {effect=10, time=60,
	msg1="#HÎåÔÂ£¬ÊÇÒ»ˆöÀ×øQáá´óÓêíÅR£¬ÄÏïwµÄ´óÑã°ÏÉ½ÉæË®šw¼ÒµÄÈÕ×Ó£»ÔÚß@ €ÂşµÄ¼¾¹#W#{_INFOUSR%s}#HÊ¹ÓÃÁËÒ»‚€#W%s#H£¬½åÒÔ×“ÃÀß@¶¬ûœ“PËëŞrÃñ“]º¹ºÉäz£¬ĞÁÇÚ¸ûÔÅµÄºÃ¹â¾°¡£",
	msg2="#H„Ú„ÓÊÇÉñÆæµÄ£¬„Ú„ÓÊÇ‚¥´óµÄ¡£„Ú„ÓÕßÓÃÇÚ„ÚµÄëpÊÖºÍÖÇ»Û£¬¾¿—ÁËß@‚€Îå²Ê°à”ÌµÄÊÀ½ç£¬„“ÔìÁËÈËîµÄÎÄÃ÷¡£#W#{_INFOUSR%s}#HÔÚß@‚€ÌØ„eµÄÈÕ×ÓÑe£¬ÔÚ#G%s#HÊ¹ÓÃÁËÒ»‚€#W%s#HÏòÈ«ÊÀ½çµÄ„Ú„ÓÕßÖÂ¾´£¡"}
x331026_g_itemList[30509066] = {effect=20, time=60,
	msg1="#HÆßÏ¦Œ¢ÖÁ£¬#W#{_INFOUSR%s}#H×òÒ¹‰ôÒŠÅ£ÀÉ¿—Å®ùo˜òÏà•ş£¬ÁwÄ½Ÿo±È£¬ì¶ÊÇÊ¹ÓÃÁËÒ»‚€#W%s#H£¬ÒÔ´ËíÏòËùÓĞ†ÎÉíµÄÈË‚ƒÉ¢²¥ÛµÄÓÌ–£¡",
	msg2="#HÆßÏ¦£¬ùo˜ò£¬ãyºÓ£¬Å£ÀÉ¿—Å®......#W#{_INFOUSR%s}#HÔÚß@‚€ÌØ„eµÄÈÕ×ÓÑe£¬Í»È»ĞÄÓĞËù¸Ğ£¬Ïò#G%s#HµÄÌì¿Õ”SÈ¥Ò»°Ñ#W%s#H£¬µÇ•r»¨Óê¼Šïw¡£"}
x331026_g_itemList[30509071] = {effect=21, time=60,
	msg1="#{AOYYH_8804_01}#W#{_INFOUSR%s}#H¼¤ÇéÅìÅÈµØ#{AOYYH_8804_03}%s#{AOYYH_8804_04}",
	msg2="#{AOYYH_8804_01}#W#{_INFOUSR%s}#H¼¤ÇéÅìÅÈµØÔÚ#G%s#{AOYYH_8804_03}%s#{AOYYH_8804_04}"}
x331026_g_itemList[30509083] = {effect=22, time=60,
	msg1="#HÊ±ÖÁÖ¿ÓÑÉú³½£¬#W#{_INFOUSR%s}#HÒàÏ²²»×Ô½û£¬ÓÚÊÇÊ¹ÓÃÁËÒ»¸ö#W%s#H£¬ÒÔ´ËÀ´±í´ï¶ÔÅóÓÑ×îÕæÖ¿µÄÉúÈÕ×£¸££¡",
	msg2="#W#{_INFOUSR%s}#HÔÚÖÁ½»ÉúÈÕÖ®¼Ê£¬ÓÚ#G%s#HÈ¼·ÅÁËÒ»¸ö#W%s#H£¬²¢×£¸£µÀ£ºÔ¸ËùÓĞµÄ¿ìÀÖ¡¢ËùÓĞµÄĞÒ¸£¡¢ËùÓĞµÄÎÂÜ°¡¢ËùÓĞµÄºÃÔË¶¼Î§ÈÆÔÚÄãÉí±ß£¬ÉúÈÕ¿ìÀÖ£¡"}
--**********************************
--ÊÂ¼ş½»»¥Èë¿Ú
--**********************************
function x331026_OnDefaultEvent( sceneId, selfId, bagIndex )
-- ²»ĞèÒªÕâ¸ö½Ó¿Ú£¬µ«Òª±£Áô¿Õº¯Êı
end

--**********************************
--Õâ¸öÎïÆ·µÄÊ¹ÓÃ¹ı³ÌÊÇ·ñÀàËÆÓÚ¼¼ÄÜ£º
--ÏµÍ³»áÔÚÖ´ĞĞ¿ªÊ¼Ê±¼ì²âÕâ¸öº¯ÊıµÄ·µ»ØÖµ£¬Èç¹û·µ»ØÊ§°ÜÔòºöÂÔºóÃæµÄÀàËÆ¼¼ÄÜµÄÖ´ĞĞ¡£
--·µ»Ø1£º¼¼ÄÜÀàËÆµÄÎïÆ·£¬¿ÉÒÔ¼ÌĞøÀàËÆ¼¼ÄÜµÄÖ´ĞĞ£»·µ»Ø0£ººöÂÔºóÃæµÄ²Ù×÷¡£
--**********************************
function x331026_IsSkillLikeScript( sceneId, selfId)
	return 1; --Õâ¸ö½Å±¾ĞèÒª¶¯×÷Ö§³Ö
end

--**********************************
--Ö±½ÓÈ¡ÏûĞ§¹û£º
--ÏµÍ³»áÖ±½Óµ÷ÓÃÕâ¸ö½Ó¿Ú£¬²¢¸ù¾İÕâ¸öº¯ÊıµÄ·µ»ØÖµÈ·¶¨ÒÔºóµÄÁ÷³ÌÊÇ·ñÖ´ĞĞ¡£
--·µ»Ø1£ºÒÑ¾­È¡Ïû¶ÔÓ¦Ğ§¹û£¬²»ÔÙÖ´ĞĞºóĞø²Ù×÷£»·µ»Ø0£ºÃ»ÓĞ¼ì²âµ½Ïà¹ØĞ§¹û£¬¼ÌĞøÖ´ĞĞ¡£
--**********************************
function x331026_CancelImpacts( sceneId, selfId )
	return 0; --²»ĞèÒªÕâ¸ö½Ó¿Ú£¬µ«Òª±£Áô¿Õº¯Êı,²¢ÇÒÊ¼ÖÕ·µ»Ø0¡£
end

--**********************************
--Ìõ¼ş¼ì²âÈë¿Ú£º
--ÏµÍ³»áÔÚ¼¼ÄÜ¼ì²âµÄÊ±¼äµãµ÷ÓÃÕâ¸ö½Ó¿Ú£¬²¢¸ù¾İÕâ¸öº¯ÊıµÄ·µ»ØÖµÈ·¶¨ÒÔºóµÄÁ÷³ÌÊÇ·ñÖ´ĞĞ¡£
--·µ»Ø1£ºÌõ¼ş¼ì²âÍ¨¹ı£¬¿ÉÒÔ¼ÌĞøÖ´ĞĞ£»·µ»Ø0£ºÌõ¼ş¼ì²âÊ§°Ü£¬ÖĞ¶ÏºóĞøÖ´ĞĞ¡£
--**********************************
function x331026_OnConditionCheck( sceneId, selfId )
	--Ğ£ÑéÊ¹ÓÃµÄÎïÆ·
	if(1~=LuaFnVerifyUsedItem(sceneId, selfId)) then
		return 0
	end
	
	local itemTblIndex = LuaFnGetItemIndexOfUsedItem( sceneId, selfId );
	local curItem = x331026_g_itemList[itemTblIndex];
	if not curItem then
		x331026_NotifyFailTips(sceneId, selfId, "Chßa m· ğÕo cø, không th¬ sØ døng.");
		return 0;
	end
	
	local curWeather = LuaFnGetSceneWeather(sceneId);
	if not curWeather or curWeather ~= -1 then
		x331026_NotifyFailTips(sceneId, selfId, "Trong không khí ğ£c thù không th¬ sØ døng v§t ph¦m này.");
		return 0;
	end

	return 1; --²»ĞèÒªÈÎºÎÌõ¼ş£¬²¢ÇÒÊ¼ÖÕ·µ»Ø1¡£
end

--**********************************
--ÏûºÄ¼ì²â¼°´¦ÀíÈë¿Ú£º
--ÏµÍ³»áÔÚ¼¼ÄÜÏûºÄµÄÊ±¼äµãµ÷ÓÃÕâ¸ö½Ó¿Ú£¬²¢¸ù¾İÕâ¸öº¯ÊıµÄ·µ»ØÖµÈ·¶¨ÒÔºóµÄÁ÷³ÌÊÇ·ñÖ´ĞĞ¡£
--·µ»Ø1£ºÏûºÄ´¦ÀíÍ¨¹ı£¬¿ÉÒÔ¼ÌĞøÖ´ĞĞ£»·µ»Ø0£ºÏûºÄ¼ì²âÊ§°Ü£¬ÖĞ¶ÏºóĞøÖ´ĞĞ¡£
--×¢Òâ£ºÕâ²»¹â¸ºÔğÏûºÄµÄ¼ì²âÒ²¸ºÔğÏûºÄµÄÖ´ĞĞ¡£
--**********************************
function x331026_OnDeplete( sceneId, selfId )
	
	local itemTblIndex = LuaFnGetItemIndexOfUsedItem( sceneId, selfId );
	local curItem = x331026_g_itemList[itemTblIndex];
	if not curItem then
		x331026_NotifyFailTips(sceneId, selfId, "Chßa m· ğÕo cø, không th¬ sØ døng.");
		return 0;
	end
	
	local itemBagIndex = LuaFnGetBagIndexOfUsedItem(sceneId, selfId);
	local szTransferItem = GetBagItemTransfer(sceneId, selfId, itemBagIndex);
	local selfName = GetName(sceneId, selfId);
	
	if(0<LuaFnDepletingUsedItem(sceneId, selfId)) then
		if szTransferItem and selfName then
			local sceneType = LuaFnGetSceneType(sceneId);
			local strMsg;
			if sceneType and sceneType == 0 then
				local sceneName = GetSceneName(sceneId);
				strMsg = format(curItem.msg2, selfName, sceneName, "#{_INFOMSG"..szTransferItem.."}");
			else
				strMsg = format(curItem.msg1, selfName, "#{_INFOMSG"..szTransferItem.."}");
			end
			BroadMsgByChatPipe(sceneId, selfId, strMsg, 4);
		end
		return 1;
	end
	return 0;
end

--**********************************
--Ö»»áÖ´ĞĞÒ»´ÎÈë¿Ú£º
--¾ÛÆøºÍË²·¢¼¼ÄÜ»áÔÚÏûºÄÍê³Éºóµ÷ÓÃÕâ¸ö½Ó¿Ú£¨¾ÛÆø½áÊø²¢ÇÒ¸÷ÖÖÌõ¼ş¶¼Âú×ãµÄÊ±ºò£©£¬¶øÒıµ¼
--¼¼ÄÜÒ²»áÔÚÏûºÄÍê³Éºóµ÷ÓÃÕâ¸ö½Ó¿Ú£¨¼¼ÄÜµÄÒ»¿ªÊ¼£¬ÏûºÄ³É¹¦Ö´ĞĞÖ®ºó£©¡£
--·µ»Ø1£º´¦Àí³É¹¦£»·µ»Ø0£º´¦ÀíÊ§°Ü¡£
--×¢£ºÕâÀïÊÇ¼¼ÄÜÉúĞ§Ò»´ÎµÄÈë¿Ú
--**********************************
function x331026_OnActivateOnce( sceneId, selfId )
	
	local itemTblIndex = LuaFnGetItemIndexOfUsedItem( sceneId, selfId );
	local curItem = x331026_g_itemList[itemTblIndex];
	if not curItem then
		x331026_NotifyFailTips(sceneId, selfId, "Chßa m· ğÕo cø, không th¬ sØ døng.");
		return 0;
	end
	
	LuaFnSetSceneWeather(sceneId, curItem.effect, curItem.time * 1000 );
	return 1;
end

--**********************************
--Òıµ¼ĞÄÌø´¦ÀíÈë¿Ú£º
--Òıµ¼¼¼ÄÜ»áÔÚÃ¿´ÎĞÄÌø½áÊøÊ±µ÷ÓÃÕâ¸ö½Ó¿Ú¡£
--·µ»Ø£º1¼ÌĞøÏÂ´ÎĞÄÌø£»0£ºÖĞ¶ÏÒıµ¼¡£
--×¢£ºÕâÀïÊÇ¼¼ÄÜÉúĞ§Ò»´ÎµÄÈë¿Ú
--**********************************
function x331026_OnActivateEachTick( sceneId, selfId)
	return 1; --²»ÊÇÒıµ¼ĞÔ½Å±¾, Ö»±£Áô¿Õº¯Êı.
end

--**********************************
-- ĞÑÄ¿Ê§°ÜÌáÊ¾
--**********************************
function x331026_NotifyFailTips( sceneId, selfId, Tip )
	BeginEvent( sceneId )
		AddText( sceneId, Tip )
	EndEvent( sceneId )
	DispatchMissionTips( sceneId, selfId )
end
